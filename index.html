<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>THW Funkrufnamen – Suche & Generator</title>
  <style>
    :root{ --bg:#0b0f14; --card:#111823; --muted:#8aa0b2; --text:#e6eef6; --accent:#4cc3ff; --accent2:#8bffb8; --border:#1e2a3a; --warn:#ffd66b; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Inter,Arial,sans-serif;background:var(--bg);color:var(--text);}
    header{padding:24px;display:flex;gap:16px;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border);backdrop-filter:saturate(120%) blur(4px);position:sticky;top:0;background:linear-gradient(180deg, rgba(11,15,20,.95), rgba(11,15,20,.85));z-index:5}
    h1{font-size:clamp(18px,4vw,24px);margin:0;letter-spacing:.2px}
    .wrap{max-width:1100px;margin:0 auto;padding:24px}
    .grid{display:grid;grid-template-columns:1.2fr .8fr;gap:24px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,.2);}
    .card h2{font-size:18px;margin:0 0 8px 0}
    .card .p{color:var(--muted);font-size:14px}
    .pad{padding:18px}
    input, select, button{background:#0c131d;border:1px solid var(--border);color:var(--text);border-radius:12px;padding:10px 12px;font-size:14px}
    input:focus, select:focus, button:focus{outline:2px solid var(--accent);}
    button{cursor:pointer}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .grow{flex:1 1 220px}
    .muted{color:var(--muted)}
    .hint{font-size:12px;color:var(--muted)}
    .result{border-top:1px dashed var(--border);margin-top:14px;padding-top:14px}
    .big{font-size:20px;font-weight:700;letter-spacing:.3px}
    .tag{display:inline-block;padding:4px 8px;border-radius:999px;background:#0b121c;border:1px solid var(--border);font-size:12px;margin-right:6px;margin-top:6px}
    .badgelite{border:1px dashed var(--border);background:#0b131d;padding:6px 10px;border-radius:999px;font-size:12px;color:var(--muted)}
    .searchbox{display:flex;gap:10px}
    .searchbox input{flex:1}
    .list{
      max-height:300px; /* Maximale Höhe für die Schnellsuche */
      overflow-y:auto;  /* Scrollbalken nur anzeigen, wenn nötig */
      border-top:1px solid var(--border);
      font-size:12px;   /* Kleinere Schriftgröße für die Schnellsuche */
    }   
    .item{padding:10px 14px;border-bottom:1px solid var(--border);display:flex;gap:12px;align-items:baseline}
    .item:hover{background:#0e1622}
    .code{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;color:var(--accent);min-width:3.2ch;display:inline-block}
    .pill{padding:2px 6px;border-radius:6px;background:#0b1a12;color:var(--accent2);border:1px solid #0f2c1b;font-size:11px}
    .hr{height:1px;background:linear-gradient(90deg,transparent,var(--border),transparent);margin:12px 0}
    footer{opacity:.7;font-size:12px;text-align:center;padding:18px}
    .warn{color:var(--warn)}
    @media (max-width: 900px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
<header class="wrap">
  <h1>THW&nbsp;Funkrufnamen – Suche & Generator</h1>
  <span class="badgelite">Keine offiziell oder durch das THW verifizierte Daten!</span>
</header>
<div class="wrap grid">
  <section class="card">
    <div class="pad">
      <h2>Generator</h2>
      <p class="p">Baue aus <strong>Einheit</strong> (erste Zifferngruppe) und <strong>Fahrzeug/Person</strong> (zweite Zifferngruppe) deinen Funkrufnamen-Baustein. Optional den <strong>Ortsnamen</strong> ergänzen. Die Checkbox filtert die Auswahl auf sinnvolle Kombinationen.<br> <strong>Das echte Mapping der Fahrzeuge und Personen zu den Einheiten ist nicht öffentlich zugänglich und könnte je nach Ortsverband und THW-Struktur variieren!</strong></p>
      <div class="row" style="margin-top:8px">
        <input id="ort" class="grow" placeholder="Ortsname (z. B. München)" />
      </div>
      <div class="row" style="margin-top:8px">
        <select id="einheit" class="grow"></select>
      </div>
      <div class="row" style="margin-top:8px">
        <select id="fahrzeug" class="grow"></select>
      </div>
      <div class="row" style="margin-top:4px;align-items:center">
        <label class="hint"><input type="checkbox" id="onlyValid" checked="checked"> Nur passende Kfz/Personen zur Einheit anzeigen</label>
      </div>
      <div class="result" id="out">
        <div class="big" id="ruf"></div>
        <div id="desc" class="muted"></div>
        <div id="tags"></div>
      </div>
      <div class="hr"></div>
      <div class="hint">Im THW steht die <em>Einheit</em> links, das <em>Fahrzeug/Person</em> rechts: <code class="code">[Einheit]/[Kfz-Art]</code>. Beispiel: <span class="pill">ZTr 1. TZ / MTW ZTr</span> → <code class="code">21/10</code>.</div>
    </div>
  </section>

  <aside class="card">
    <div class="pad">
      <h2>Schnellsuche</h2>
      <div class="searchbox">
        <input id="q" placeholder="Suche nach Einheit, Fahrzeug oder Person… (z. B. &quot;Zugtrupp&quot;, &quot;GKW&quot;, &quot;Zugführer&quot;)"/>
        <button id="clear">Löschen</button>
      </div>
      <div class="list" id="list"></div>
      <p class="hint" style="margin-top:10px">Klick auf einen Treffer füllt den Generator automatisch aus.</p>
    </div>
  </aside>
</div>

<footer>
  Dieses Tool dient der Ausbildung/Vorbereitung. Verbindlich sind die geltende <abbr title="Funk-Rufnamen-Regelung des THW">THW-FuRnR</abbr> und lokale Weisungen/TBZen. Angaben ohne Gewähr.
</footer>

<script>
// ===== Konfiguration (optional) =====
const OV_EINHEITEN = null; // z. B.: ['21','22','24','31','61']

// ===== Stammdaten =====
const EINHEITEN = [
  {code:'00', name:'TTB (Taktisch-Technische Betriebsstelle)'},
  {code:'10', name:'THW-Führungsstelle (TEL/EAL/UEAL/BR) – nur im Einsatz'},
  {code:'11', name:'nachgeordnete Führungsstelle – im Einsatz'},
  {code:'12', name:'nachgeordnete Führungsstelle – im Einsatz'},
  {code:'13', name:'nachgeordnete Führungsstelle – im Einsatz'},
  {code:'14', name:'nachgeordnete Führungsstelle – im Einsatz'},
  {code:'15', name:'nachgeordnete Führungsstelle – im Einsatz'},
  {code:'16', name:'Zugtrupp Fachzug Führung/Kommunikation'},
  {code:'17', name:'Fachgruppe Führungsunterstützung'},
  {code:'18', name:'Fachgruppe Kommunikation (Typ A)'},
  {code:'19', name:'Fachgruppe Kommunikation (Typ B)'},
  {code:'21', name:'1. Technischer Zug (ZTr/Zug/Zug-Befehlsstelle)'},
  {code:'22', name:'Bergungsgruppe im 1. TZ'},
  {code:'23', name:'2. Bergungsgruppe im 1. TZ'},
  {code:'24', name:'Fachgruppe Notversorgung/Notinstandsetzung im 1. TZ'},
  {code:'26', name:'2. Technischer Zug (ZTr/Zug/Zug-Befehlsstelle)'},
  {code:'27', name:'Bergungsgruppe im 2. TZ'},
  {code:'28', name:'Fachgruppe Notversorgung/Notinstandsetzung im 2. TZ'},
  {code:'31', name:'Fachgruppe Infrastruktur'},
  {code:'32', name:'Fachgruppe Elektroversorgung'},
  {code:'33', name:'Fachgruppe Trinkwasserversorgung'},
  {code:'35', name:'Fachgruppe Sprengen'},
  {code:'36', name:'Fachgruppe Wassergefahren (Typ A)'},
  {code:'37', name:'Fachgruppe Wassergefahren (Typ B)'},
  {code:'38', name:'Fachgruppe Schwere Bergung (Typ A)'},
  {code:'39', name:'Fachgruppe Schwere Bergung (Typ B)'},
  {code:'41', name:'Fachgruppe Räumen (B) – Radlader'},
  {code:'42', name:'Fachgruppe Räumen (A) – Bagger'},
  {code:'43', name:'Fachgruppe Räumen (C) – Teleskoplader'},
  {code:'44', name:'Fachgruppe Ortung (Typ A)'},
  {code:'45', name:'Fachgruppe Ortung (Typ B)'},
  {code:'46', name:'Fachgruppe Ortung (Typ C)'},
  {code:'47', name:'Fachgruppe Wasserschaden/Pumpen (A)'},
  {code:'48', name:'Fachgruppe Wasserschaden/Pumpen (B)'},
  {code:'49', name:'Fachgruppe Wasserschaden/Pumpen (C)'},
  {code:'54', name:'Fachgruppe Brückenbau'},
  {code:'55', name:'Fachgruppe Ölschaden (A) – Küste'},
  {code:'56', name:'Fachgruppe Ölschaden (B) – Küste'},
  {code:'57', name:'Fachgruppe Ölschaden (C) – Binnen'},
  {code:'61', name:'Fachzug Logistik – Zugtrupp/Zug/Zug-Befehlsstelle'},
  {code:'62', name:'Trupp Schwerer Transport'},
  {code:'63', name:'Fachgruppe Logistik Materialwirtschaft'},
  {code:'64', name:'Fachgruppe Logistik Verpflegung'},
  {code:'71', name:'Zugtrupp (sonstige Einheiten, z. B. 3. TZ)'},
  {code:'72', name:'1. Gruppe (sonstige Einheiten)'},
  {code:'73', name:'2. Gruppe (sonstige Einheiten)'},
  {code:'74', name:'Trupp Mobiler Hochwasserpegel'},
  {code:'75', name:'Trupp Einsatzstellensicherung'},
  {code:'76', name:'Trupp Unbemannte Luftfahrtsysteme'},
  {code:'79', name:'Örtliche Gefahrenabwehr (ÖGA, genehmigt)'},
  {code:'81', name:'THW-Leitung'},
  {code:'82', name:'THW-Ausbildungszentrum'},
  {code:'83', name:'THW-Logistikzentrum/-halle'},
  {code:'84', name:'Landesverband (Dienststelle)'},
  {code:'85', name:'Regionalstelle'},
  {code:'86', name:'Ortsverband/Stab'},
  {code:'91', name:'SEEBA'},
  {code:'92', name:'SEELIFT'},
  {code:'93', name:'SEEWA'},
  {code:'94', name:'Führungsstelle – nur im Einsatz'},
  {code:'95', name:'Führungsstelle – nur im Einsatz'},
  {code:'96', name:'Führungsstelle – nur im Einsatz'},
  {code:'97', name:'Führungsstelle – nur im Einsatz'},
  {code:'98', name:'Führungsstelle – nur im Einsatz'},
  {code:'99', name:'Führungsstelle – nur im Einsatz'}
];

const KFZ_PERSON = [
  {code:'10', name:'MTW des Zugtrupp (ZTr)'},
  {code:'11', name:'Führungs-Kraftwagen (nur FZ FüKom)'},
  {code:'12', name:'FüKomKW (nur FGr Führung)'},
  {code:'13', name:'Fernmeldekraftwagen (nur FGr Kommunikation)'},
  {code:'14', name:'FüKomKW – Übergangslösung'},
  {code:'15', name:'FmKW – Übergangslösung'},
  {code:'17', name:'Mastkraftwagen (nur FGr K Typ B)'},
  {code:'21', name:'PKW – 1. der Teileinheit'},
  {code:'22', name:'PKW – 2. der Teileinheit'},
  {code:'23', name:'PKW – 3. der Teileinheit'},
  {code:'24', name:'PKW – 4. der Teileinheit'},
  {code:'25', name:'MTW – 1. der Teileinheit'},
  {code:'26', name:'MTW – 2. der Teileinheit'},
  {code:'27', name:'MTW – 3. der Teileinheit'},
  {code:'28', name:'MTW – 4. der Teileinheit'},
  {code:'31', name:'MLW I (ehem. ITrKW)'},
  {code:'32', name:'MLW II'},
  {code:'33', name:'MLW III'},
  {code:'34', name:'MLW IV'},
  {code:'35', name:'MLW V'},
  {code:'41', name:'LKW ≤ 7 t'},
  {code:'42', name:'LKW > 7 t'},
  {code:'43', name:'LKW mit Ladebordwand'},
  {code:'44', name:'LKW mit Ladekran < 190 kNm'},
  {code:'45', name:'LKW mit Ladekran ≥ 190 kNm'},
  {code:'46', name:'LKW mit Ladekran (geländegängig)'},
  {code:'47', name:'Autokran'},
  {code:'49', name:'zweiter LKW mit Lbw (FGr TW)'},
  {code:'51', name:'GKW'},
  {code:'52', name:'GKW II (neue Gen.)'},
  {code:'53', name:'GKW II (Übergang)'},
  {code:'54', name:'MzKW'},
  {code:'55', name:'MzGW'},
  {code:'56', name:'sonstiger Gerätewagen'},
  {code:'57', name:'BelKW (Beleuchtung)'},
  {code:'61', name:'LKW-Kipper < 9 t'},
  {code:'62', name:'LKW-Kipper ≥ 9 t'},
  {code:'63', name:'LKW-Kipper mit Ladekran < 190 kNm'},
  {code:'64', name:'LKW-Kipper mit Ladekran ≥ 190 kNm'},
  {code:'65', name:'Wechselladerfahrzeug (WLF) Hakensystem'},
  {code:'66', name:'WLF mit Ladekran (Hakensystem)'},
  {code:'67', name:'WLF Wechselpritsche'},
  {code:'68', name:'Sattel-Kfz (Zugmaschine/Auflieger)'},
  {code:'71', name:'Bergungsräumgerät – Bagger'},
  {code:'72', name:'Bergungsräumgerät – Radlader'},
  {code:'73', name:'Bergungsräumgerät – Teleskoplader'},
  {code:'74', name:'sonstige Baumaschine'},
  {code:'75', name:'ERS (Rettungsspinne)'},
  {code:'77', name:'sonstige Kraftfahrzeuge'},
  {code:'78', name:'sonstige Fahrzeuge (z. B. Wechselbrücken)'},
  {code:'79', name:'KOM/Bus (Reisebus)'},
  {code:'81', name:'Mehrzweckarbeitsboot'},
  {code:'82', name:'Mehrzweckarbeitsboot'},
  {code:'83', name:'Mehrzweckponton'},
  {code:'84', name:'Mehrzweckponton'},
  {code:'85', name:'sonstiges Wasserfahrzeug'},
  {code:'86', name:'sonstiges Wasserfahrzeug'},
  {code:'91', name:'Führungskraft / Dienststellenleiter(in)'},
  {code:'92', name:'Stellvertretung von Führungskraft / Dienststellenleiter(in) (91)'},
  {code:'94', name:'Fachberater(in)'},
  {code:'95', name:'Fachberater(in)'},
  {code:'96', name:'Technische(r) Berater(in)'},
  {code:'97', name:'Leiter(in) THW-Führungsstelle (nur im Einsatz)'},
  {code:'98', name:'S6 (Fernmeldeführer/in) – nur im Einsatz'}
];

// Praxis-Mapping: Einheit → erlaubte Kfz-/Personen-Codes (vereinfachte, sinnvolle Auswahl)
const MAP_E2K = {
  '21': ['10','21','22','25','26','91','92'],
  '26': ['10','21','22','25','26','91','92'],
  '22': ['51','54','55','31','32','41','42','43','57','91','92'],
  '23': ['51','54','55','31','32','41','42','43','57'],
  '24': ['55','31','32','33','34','35','41','42','43','44','45','57','91','92'],
  '27': ['51','54','55','31','32','41','42','43','57','91','92'],
  '28': ['55','31','32','33','34','35','41','42','43','44','45','57','91','92'],
  '31': ['31','32','33','34','35','54','55','41','42','43','44','45','91','92'],
  '32': ['41','42','43','44','45','54','31','32','49','91','92'],
  '33': ['41','42','43','54','31','32','49','91','92'],
  '36': ['41','42','43','44','45','65','66','67','81','82','83','84','85','86','91','92'],
  '37': ['41','42','43','44','45','65','66','67','81','82','83','84','85','86','91','92'],
  '38': ['54','56','41','42','43','44','45','71','72','73','74','91','92'],
  '39': ['54','56','41','42','43','44','45','71','72','73','74','91','92'],
  '41': ['61','62','63','64','41','42','43','68','71','72','73','91','92'],
  '42': ['61','62','63','64','41','42','43','68','71','72','73','91','92'],
  '43': ['61','62','63','64','41','42','43','68','71','72','73','91','92'],
  '44': ['31','32','33','34','35','55','21','25','26','91','92'],
  '45': ['31','32','33','34','35','55','21','25','26','91','92'],
  '46': ['31','32','33','34','35','55','21','25','26','91','92'],
  '47': ['41','42','43','49','54','55','65','66','67','91','92'],
  '48': ['41','42','43','49','54','55','65','66','67','91','92'],
  '49': ['41','42','43','49','54','55','65','66','67','91','92'],
  '54': ['41','42','43','44','45','65','66','67','91','92'],
  '61': ['21','25','26','41','42','43','44','45','65','66','67','91','92'],
  '62': ['68','41','42','43','44','45','91','92'],
  '63': ['31','32','33','34','35','41','42','43','44','45','91','92'],
  '64': ['41','42','43','91','92'],
  '71': ['21','25','26','91','92'],
  '72': ['31','32','41','42','43','55','91','92'],
  '73': ['31','32','41','42','43','55','91','92'],
  '74': ['21','25','26','31','32','41','42','43','55','91','92'],
  '75': ['21','25','26','31','32','41','42','43','91','92'],
  '76': ['21','25','26','31','32','41','42','43','91','92'],
  '79': ['21','22','25','26','31','32','41','42','43','55','91','92'],
  '81': ['21','22','91','92','94','95','96'],
  '84': ['21','22','91','92'],
  '85': ['21','22','91','92'],
  '86': ['21','22','91','92','94','95','96']
};

// ===== Funktion zum Bereinigen von Leerzeichen =====
function pretty(s){
  s = (s || '').toString();
  let out = '';
  let wasSpace = false;
  for (let i = 0; i < s.length; i++) {
    const ch = s[i];
    const isSpace = (ch === ' ' || ch === '\n' || ch === '\r' || ch === '\t' || ch === '\f');
    if (isSpace) { if (!wasSpace) { out += ' '; wasSpace = true; } }
    else { out += ch; wasSpace = false; }
  }
  return out.trim();
}

// ===== UI =====
const selE = document.getElementById('einheit');
const selK = document.getElementById('fahrzeug');
const ort = document.getElementById('ort');
const ruf = document.getElementById('ruf');
const desc = document.getElementById('desc');
const tags = document.getElementById('tags');
const list = document.getElementById('list');
const q = document.getElementById('q');
const clearBtn = document.getElementById('clear');
const onlyValid = document.getElementById('onlyValid');

function opt(label, value){ const o=document.createElement('option'); o.textContent=`[${value}] ${label}`; o.value=value; return o; }

function fillEinheiten(){
  selE.innerHTML=''; selE.appendChild(opt('— Einheit wählen —',''));
  const src = Array.isArray(OV_EINHEITEN) && OV_EINHEITEN.length
    ? EINHEITEN.filter(e=> OV_EINHEITEN.includes(e.code))
    : EINHEITEN;
  src.forEach(e=> selE.appendChild(opt(e.name, e.code)));
}

function fillFahrzeuge(){
  selK.innerHTML=''; selK.appendChild(opt('— Fahrzeug/Person wählen —',''));
  let set = KFZ_PERSON; const eCode = selE.value;
  if(onlyValid && onlyValid.checked && eCode && MAP_E2K[eCode]){
    const allowed = new Set(MAP_E2K[eCode]);
    set = KFZ_PERSON.filter(k=> allowed.has(k.code));
  }
  set.forEach(f=> selK.appendChild(opt(f.name, f.code)));
}

function render(){
  const e = EINHEITEN.find(x=> x.code===selE.value);
  const k = KFZ_PERSON.find(x=> x.code===selK.value);
  const pre = ['HEROS', pretty(ort.value||'Ortsname?')];
  const left = e? e.code : '??';
  const right = k? k.code : '??';
  ruf.textContent = `${pre.join(' ')} – ${left}/${right}`;
  const parts=[]; if(e) parts.push(`<span class="tag">Einheit: [${e.code}] ${e.name}</span>`); if(k) parts.push(`<span class="tag">Kfz/Person: [${k.code}] ${k.name}</span>`);
  tags.innerHTML = parts.join(' ');
  desc.textContent = (e&&k) ? `Baustein gemäß THW‑FuRnR: ${e.code}/${k.code}.` : 'Bitte Einheit und Kfz/Person auswählen.';
}

function buildIndex(){
  const items=[];
  for(const e of EINHEITEN){ items.push({type:'Einheit', code:e.code, name:e.name}); }
  for(const k of KFZ_PERSON){ items.push({type:'Fahrzeug', code:k.code, name:k.name}); }
  return items.sort((a,b)=> a.type.localeCompare(b.type,'de') || a.code.localeCompare(b.code));
}
const INDEX = buildIndex();

function renderList(filter=''){
  const f = (filter||'').trim().toLowerCase();
  list.innerHTML='';
  const rows = INDEX.filter(it => !f || it.name.toLowerCase().includes(f) || it.code.includes(f));
  if(!rows.length){ list.innerHTML = `<div class="item"><span class="muted">Keine Treffer.</span></div>`; return; }
  for(const it of rows){
    const div = document.createElement('div');
    div.className='item';
    div.innerHTML = `<span class="pill">${it.type}</span> <span class="code">${it.code}</span> <span>${it.name}</span>`;
    div.addEventListener('click', ()=>{
      if(it.type==='Einheit'){ selE.value = it.code; fillFahrzeuge(); }
      else { selK.value = it.code; }
      render();
      window.scrollTo({top:0, behavior:'smooth'});
    });
    list.appendChild(div);
  }
}

// ===== Events =====
selE.addEventListener('change', ()=>{ fillFahrzeuge(); render(); });
selK.addEventListener('change', render);
if(onlyValid) onlyValid.addEventListener('change', ()=>{ fillFahrzeuge(); render(); });
if(ort) ort.addEventListener('input', render);
if(q) q.addEventListener('input', ()=> renderList(q.value));
if(clearBtn) clearBtn.addEventListener('click', ()=>{ q.value=''; renderList(''); q.focus(); });

// ===== Init =====
window.addEventListener('DOMContentLoaded', () => {
  try {
    fillEinheiten();
    fillFahrzeuge();
    render();
    renderList('');
  } catch (err) {
    console.error(err);
    alert('Init-Fehler: ' + err.message);
  }
});
</script>
</body>
</html>
